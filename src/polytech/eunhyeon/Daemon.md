---
layout: home
---

# 리눅스 - Daemon
## 0427. 서비스와 데몬 및 데몬의 실행 및 관리
<hr/>

> 리눅스 우분투에서 **서비스와 데몬**은 시스템 관리를 위해 중요한 역할을 함.   
서비스와 데몬은 시스템 전체에서 실행되며, 자동으로 시작되고 종료됨.   

- 리눅스 우분투에서 서비스와 데몬의 실행 및 관리 방법
    1. 서비스는 리눅스 우분투에서 **systemd**라는 시스템과 서비스 관리 도구를 통해 실행됨. 
    2. **systemd**는 리눅스 우분투에서 시스템과 프로세스를 시작하고 중지하는 데 사용됨.
    3. **systemd**는 각 서비스에 대한 구성 파일을 */etc/systemd/system* 디렉토리에 저장함.
    4. 각 서비스는 .service 확장자를 가진 파일로 구성됨. 이 파일에는 서비스를 실행하는 명령, 서비스가 사용하는 환경 변수 및 서비스 구동 시 필요한 종속성 정보가 포함됨.
    ![systemctl](./images/systemctl.png)
- 서비스를 시작, 중지, 재시작 또는 다시 로드하는 방법

    - 서비스 시작: `sudo systemctl start [서비스 이름]`
    - 서비스 중지: `sudo systemctl stop [서비스 이름]`
    - 서비스 재시작: `sudo systemctl restart [서비스 이름]`
    - 서비스 다시 로드: `sudo systemctl reload [서비스 이름]`

-> 데몬은 리눅스 우분투에서 systemd 또는 Upstart라는 서비스 관리 도구를 통해 실행됨. Upstart는 이전에 init으로 알려진 서비스 관리자임. 하지만 이제 systemd가 기본 서비스 관리자로 대체되었음.

- 데몬을 실행하는 방법
    - 데몬 실행: `sudo service [데몬 이름] start`
    - 데몬 중지: `sudo service [데몬 이름] stop`
    - 데몬 재시작: `sudo service [데몬 이름] restart`
    - 데몬 상태 확인: `sudo service [데몬 이름] status`
    ![systemctl](./images/initd.png)

    1. 데몬은 *init.d* 디렉토리의 스크립트 파일을 사용하여 실행됨.   
    2. 스크립트 파일에는 데몬이 실행될 때 수행해야 할 명령, 데몬이 사용하는 환경 변수 및 데몬 구동 시 필요한 종속성 정보가 포함됨.    
    3. 데몬의 실행 및 종료는 다음 명령을 사용하여 관리할 수 있음.
    
    4. 서비스와 데몬 모두 시스템 자원을 사용하기 때문에, 이들을 잘 관리하는 것이 중요함. 
    5. 일부 서비스와 데몬은 시스템 부팅 시 자동으로 시작되도록 설정되어 있음. 이 경우, 서비스와 데몬이 필요하지 않을 때는 종료해야 하며, 필요한 경우에만 실행되도록 설정해야 함.

    6. 서비스와 데몬을 정기적으로 감시하여 오류를 검출하고 적절한 조치를 취해야 함. 이를 위해 로그 파일을 모니터링하고 시스템 모니터링 도구를 사용할 수 있음. 예를 들어, systemd의 journalctl 명령을 사용하여 서비스 및 데몬 로그를 볼 수 있음.

    7. 서비스와 데몬의 **보안을 유지**하는 것도 중요함. 시스템에 권한이 있는 **사용자만이 서비스와 데몬을 수정하고 실행할 수 있도록 권한을 설정해야 함**. 또한, 서비스와 데몬이 사용하는 포트 및 프로토콜에 대한 접근을 제한하는 방화벽 규칙을 설정해야 함. 이렇게 함으로써 시스템 보안을 강화하고 불필요한 위협을 방지할 수 있음.   

    서비스와 데몬이 사용하는 포트 및 프로토콜에 대한 접근을 제한하는 방법 중 하나는, 방화벽을 사용하여 해당 포트와 프로토콜에 대한 접근을 허용하거나 차단하는 것입니다.

    우분투에서는 기본적으로 ufw(Uncomplicated Firewall)라는 간단한 방화벽 도구가 제공됩니다. ufw를 사용하여 방화벽 규칙을 설정하려면 다음과 같은 명령을 사용합니다.

    ```linux
    sudo ufw enable
    sudo ufw allow 80/tcp
    sudo ufw deny 53/udp
    sudo ufw default deny
    ```
    특정 포트 및 프로토콜에 대한 접근을 허용합니다. 이 예제에서는 TCP 포트 80을 열어 웹 서버에 대한 접근을 허용합니다.

    특정 포트 및 프로토콜에 대한 접근을 차단합니다. 이 예제에서는 UDP 포트 53을 차단하여 DNS 서버에 대한 외부 접근을 막습니다.

    기본 정책을 설정합니다. 이 예제에서는 방화벽에서 허용되지 않은 트래픽은 모두 차단합니다.

    위와 같이 설정하면 ufw에서 허용되지 않은 트래픽은 차단되며, 허용된 포트와 프로토콜에 대해서만 접근이 허용됩니다. 서비스와 데몬이 사용하는 포트 및 프로토콜에 대한 접근을 제한하는 방법으로 방화벽 설정이 매우 중요합니다.