---
layout: home
---


# [책 정리] 29.반복문

## 루프 돌기(반복)

쉘 스크립트를 사용하면 프로그래밍 언어를 사용하듯이 반복문을 사용할 수 있다.  `while` 구문은 조건이 참인 동안 반복 실행되며, 조건이 거짓이 되면 반복이 중지된다. 

```
#!/bin/bash

# whille-count: display a series of numbers

count=1

while [ $count -le 5 ]; do
			  echo $count
				count=$((count + 1))
done
echo "Finished."
```

위 구문은 count라는 변수를 생성하고 count가 5 이하라면 while문을 실행하는 반복문이다. while 문을 실행할 때마다 count 값을 출력하고 값을 +1 증가 시키며 반복문이 종료되면 “Finished.”라는 문자를 출력한다.

**실행 결과**

![Untitled](https://user-images.githubusercontent.com/53002135/235449529-1e5f51f8-d388-4448-b6da-ac8117161f3b.png)

28장의 read-menu 프로그램을 루프를 활용해 다시 작성한 코드이다.

```bash
#!/bin/bash

# while-menu : a menu driven system information program

DELAY=3 # Number of seconds to display results

while [[ $REPLY != 0 ]]; do

	clear
	cat <<- _EOF_
			Please Select:

			1. Display System Information
			2. Display Disk Space
			3. Dispaly Home Space Utilization
			0. Quit
	_EOF_
	read -p "Enter selection [0-3] > "
	if [[ $REPLY =~ ^[0-3]$ ]]; then 
		if [[ $REPLY == 1 ]]; then 
			echo "Hostname: $HOSTNAME" 
			uptime 
			sleep $DELAY 
		fi 
		if [[ $REPLY == 2 ]]; then 
			df -h 
			sleep $DELAY 
		fi 
		if [[ $REPLY == 3 ]]; then 
			if [[ $(id -u) -eq 0 ]]; then 
				echo "Home Space Utilization (All Users) " 
				du -sh /home/* 
			else
				echo "Home Space Utilization ($USER)" 
				du -sh $HOME
			fi 
			sleep $DELAY 
		fi 
	else
		echo "Invalid entry."
		sleep $DELAY 
	fi
done
echo "Program terminated."
```

**실행 결과**

![Untitled](https://user-images.githubusercontent.com/53002135/235449574-25ea82d2-2fc5-4336-9f1a-4b5939584277.png)

## 루프 탈출

bash는 반복문을 제어하기 위해 두 가지 명령어(break, continue)를 제공한다. break 명령어는 즉각적으로 루프를 중단하고 프로그램이 루프 다음에 나오는 구문들을 실행하도록 한다. cotninue 명령어는 루프가 진행되는 중간에 뒤에 남은 내용을 건너띄고 다음 루프의 처음 부터 실해앟도록한다. 

```bash
#!/bin/bash

# while-menu : a menu driven system information program

DELAY=3 # Number of seconds to display results

while true; do

	clear
	cat <<- _EOF_
			Please Select:

			1. Display System Information
			2. Display Disk Space
			3. Dispaly Home Space Utilization
			0. Quit
	_EOF_
	read -p "Enter selection [0-3] > "
	if [[ $REPLY =~ ^[0-3]$ ]]; then 
		if [[ $REPLY == 1 ]]; then 
			echo "Hostname: $HOSTNAME" 
			uptime 
			sleep $DELAY
			continue
		fi 
		if [[ $REPLY == 2 ]]; then 
			df -h 
			sleep $DELAY 
			continue
		fi 
		if [[ $REPLY == 3 ]]; then 
			if [[ $(id -u) -eq 0 ]]; then 
				echo "Home Space Utilization (All Users) " 
				du -sh /home/* 
			else
				echo "Home Space Utilization ($USER)" 
				du -sh $HOME
			fi 
			sleep $DELAY
			continue
		fi
		if [[ $REPLY == 0 ]]; then
			break
		fi 
	else
		echo "Invalid entry."
		sleep $DELAY 
	fi
done
echo "Program terminated."
```

**실행결과**

![Untitled](https://user-images.githubusercontent.com/53002135/235449601-a252dac5-4149-4291-93e7-4c0dfeec65d4.png)

이전 코드와의 차이점은 while true로 무한루프를 기본 값으로 설정한 후 1 ~ 3사이의 값이 입력으로 들어오면 해당 구문을 실행한 후 continue를 이용해 남은 코드의 실행을 건너 띄고 다시 입력을 받고 0이 입력으로 들어오면 break로 루프를 탈출해 스크립트를 종료한다는 점이다. 

## until

until 명령어는 0이 아닌 종료 상태를 만났을 때 루프를 종료하는 대신에 계속 수행된다는 것만 제외하고 while과 동일하다. until 루프는 종료 상태 값으로 0을 받을 때까지 계속된다. 이전에 작성했던 count 변수의 값이 5보다 작거나 같은 동안에 루프를 반복시키는 스크립트를 until을 이용해서 똑같은 결과를 만들 수 있다. 

```bash
#!/bin/sh

# until-count: display a series of numbers

count=1

until [ $count -gt 5]; do
        echo $count
        count=$((count + 1))
done
echo "Finished."
```

**실행결과**

![Untitled](https://user-images.githubusercontent.com/53002135/235449649-a1b90942-0842-46b6-b03e-33ac51b9eb14.png)

## 루프를 이용한 파일 읽기

whlie 및 until 명령으로 표준 입력을 처리할 수 있다. 즉 while과 until로 파일을 처리할 수 있다는 것이다. 

![Untitled](https://user-images.githubusercontent.com/53002135/235449680-70827aab-8f46-40b7-9e80-e2c6bd140c2b.png)

위 스크립트는 파일의 끝에 도달할 때까지 read를 수행할 것이다. 파일의 끝에 도달하여 루프가 종료되면 distros.txt 에 내용을 표시한다.