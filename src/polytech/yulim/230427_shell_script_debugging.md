# 쉘 스크립트에서 디버깅하는 방법

쉘 스크립트에서 디버깅을 하는 방법은 크게 세 가지로 나눌 수 있습니다. 첫째는 쉘 스크립트 내에 echo 문을 추가하여 변수 값 등을 출력하는 방법이며, 둘째는 set 명령어를 사용하여 쉘 스크립트의 실행 과정을 자세히 출력하는 방법입니다. 셋째는 디버거(Debugger)를 사용하는 방법입니다.

## 1. echo문을 추가하여 디버깅하기

가장 기본적인 디버깅 방법은 echo문을 추가하는 것입니다. 쉘 스크립트 내에서 변수 값을 출력하거나, 특정 위치에서 실행이 멈추는지 확인하기 위해 echo문을 추가할 수 있습니다. 예를 들어, 다음과 같은 스크립트가 있다고 가정해 봅시다.

```bash
#!/bin/bash
a=10
b=5
c=$a/$b
echo $c
```

위 스크립트는 변수 c에 a를 b로 나눈 값을 저장하고, c를 출력하는 내용입니다. 그러나 이 스크립트를 실행하면 결과로 "10/5"가 출력됩니다. 그 이유는 c 변수에 대입한 값을 수식으로 계산하려 하지만, 스크립트 내에서는 명령어로 인식하기 때문입니다. 변수 c에 문자열 "10/5"가 할당된 것이며, 이 문자열을 그대로 출력하는 것입니다. 따라서 이러한 문제를 해결하기 위해 echo문을 추가하여 변수 값을 확인할 수 있습니다.

변수 c에 정확한 계산 결과를 할당하려면, 다음과 같이 수정해주어야 합니다.

```bash
#!/bin/bash
a=10
b=5
c=$(($a/$b)) # 변수 c에 수식의 계산 결과를 저장
echo "c 값: $c" # 변수 c 값을 출력
```

이렇게 수정하면, 변수 c에는 2가 할당되며, 결과로 "2"가 출력됩니다. 이처럼, 쉘 스크립트에서는 변수에 값을 할당할 때 적절한 형변환을 해주어야 합니다. 그렇지 않으면 원하는 결과를 얻지 못할 수 있습니다.

다른 예시를 더 봅시다.

```bash
#!/bin/bash
echo "Starting script..."

a=10
b=20

echo "a = $a"
echo "b = $b"

result=$(($a + $b))

echo "Result = $result"
```

이 스크립트는 a와 b를 더한 결과를 출력하는 간단한 예제입니다. 이제 이 스크립트를 실행해보면, 다음과 같은 결과를 얻을 수 있습니다.

```bash
Starting script...
a = 10
b = 20
Result = 30
```

echo문을 추가하여 디버깅하면, 실행 중인 스크립트에서 현재 진행되고 있는 부분을 쉽게 파악할 수 있습니다. 위의 스크립트에서는 echo문을 사용하여 현재 실행 중인 부분의 변수 값을 출력하고 있습니다. 이를 통해 스크립트 실행 중에 어떤 값이 할당되는지, 어떤 명령어가 실행되는지 등을 확인할 수 있습니다.

또한, echo문을 사용하여 디버깅할 때는 변수의 값을 적절히 출력해주는 것이 매우 중요합니다. 변수 값이 정상적으로 할당되지 않거나, 변수가 비어있을 경우에는 이를 확인하기 위해 echo문을 사용하여 출력해주어야 합니다. 이를 통해 오류가 발생한 부분을 빠르게 찾을 수 있습니다.

## 2. set 명령어를 사용하여 디버깅하기

set 명령어는 쉘 스크립트의 디버깅에 매우 유용합니다. set 명령어를 사용하면 쉘 스크립트가 실행되는 과정에서 명령어와 변수 값 등이 출력됩니다. 이를 통해 스크립트의 실행 과정을 자세히 파악할 수 있습니다.

다음은 set 명령어를 사용한 예시입니다.

```bash
#!/bin/bash
set -x # set 명령어를 사용하여 디버깅 모드로 설정
a=10
b=5
c=$(($a/$b))
echo "c 값: $c"
set +x # set 명령어를 사용하여 디버깅 모드를 해제
```

위 스크립트에서 set -x 명령어를 사용하여 디버깅 모드로 설정하고, set +x 명령어로 디버깅 모드를 해제합니다. 디버깅 모드로 설정하면, 스크립트 실행 과정에서 명령어와 변수 값 등이 자세히 출력되므로, 이를 통해 스크립트 실행 중에 어떤 명령어가 실행되는지, 어떤 변수 값이 할당되는지 등을 확인할 수 있습니다.

이 명령어는 쉘 스크립트를 실행할 때 스크립트가 어떤 명령어를 실행하고 있는지, 변수에 어떤 값이 할당되어 있는지 등을 출력합니다.

예를 들어, 다음과 같은 간단한 스크립트를 생각해봅시다.

```bash
#!/bin/bash

a=10
b=20

result=$(($a + $b))

echo "Result = $result"
```

이 스크립트를 실행할 때, **`set -x`** 명령어를 추가하여 디버깅을 할 수 있습니다. 스크립트의 첫 번째 줄에 **`set -x`**를 추가하면, 이후에 실행되는 모든 명령어와 변수 값이 출력됩니다.

```bash
#!/bin/bash

set -x
a=10
b=20

result=$(($a + $b))

echo "Result = $result"
```

이 스크립트를 실행하면, 다음과 같은 결과를 얻을 수 있습니다.

```bash
+ a=10
+ b=20
+ result=30
+ echo 'Result = 30'
Result = 30
```

위 결과에서 **`set -x`** 명령어에 의해 스크립트가 실행되는 모든 명령어와 변수 값이 출력되고 있습니다. 이를 통해 어떤 명령어에서 오류가 발생하거나, 변수에 원하는 값이 할당되지 않았는지 확인할 수 있습니다.

**`set -x`** 명령어를 사용한 디버깅은 문제가 발생한 부분을 빠르게 파악할 수 있어 매우 편리합니다. 하지만 출력되는 정보가 많기 때문에, 디버깅이 끝나면 **`set +x`** 명령어를 사용하여 디버깅 모드를 종료해주는 것이 좋습니다.


## 3. 디버거(Debugger)를 사용하여 디버깅하기

쉘 스크립트의 디버깅을 더욱 효과적으로 하기 위해서는 디버거(Debugger)를 사용할 수도 있습니다. 디버거는 스크립트를 실행하면서 언제든지 실행을 중단하고, 실행 중인 상태에서 변수 값을 확인하거나, 스크립트를 한 줄씩 실행해볼 수 있는 도구입니다.

대표적인 쉘 스크립트 디버거 도구로는 bashdb, shdb, kshdb 등이 있습니다. 이러한 도구를 사용하면, 디버깅을 더욱 효과적으로 할 수 있으며, 복잡한 스크립트에서 발생하는 오류를 더욱 빠르게 찾아낼 수 있습니다.